<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>想给你讲个故事</title>
  
  <subtitle>个人博客，欢迎交流</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://blog.uazw.com/"/>
  <updated>2020-06-16T13:17:15.244Z</updated>
  <id>http://blog.uazw.com/</id>
  
  <author>
    <name>Yong Wu</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>MySQL 执行大批量 SQL 文件随记</title>
    <link href="http://blog.uazw.com/2016/09/25/SQL/MySQL%20%E6%89%A7%E8%A1%8C%E5%A4%A7%E6%89%B9%E9%87%8F%20SQL%20%E6%96%87%E4%BB%B6%E9%9A%8F%E8%AE%B0/"/>
    <id>http://blog.uazw.com/2016/09/25/SQL/MySQL%20%E6%89%A7%E8%A1%8C%E5%A4%A7%E6%89%B9%E9%87%8F%20SQL%20%E6%96%87%E4%BB%B6%E9%9A%8F%E8%AE%B0/</id>
    <published>2016-09-25T04:13:00.000Z</published>
    <updated>2020-06-16T13:17:15.244Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Tue Jun 16 2020 13:17:34 GMT+0000 (Coordinated Universal Time) --><h1 id="mysql-执行大批量-sql-文件随记"><a class="markdownIt-Anchor" href="#mysql-执行大批量-sql-文件随记"></a> MySQL 执行大批量 SQL 文件随记</h1><h4 id="navicat-导出后导入报错-1067-invalid-default-value-for-字段名"><a class="markdownIt-Anchor" href="#navicat-导出后导入报错-1067-invalid-default-value-for-字段名"></a> navicat 导出后导入报错 <code>1067 - Invalid default value for '字段名'</code></h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 直接在 SQL 文件最前面加入以下内容</span></span><br><span class="line"><span class="comment">-- explicit_defaults_for_timestamp 变量, 默认为 OFF</span></span><br><span class="line"><span class="comment">-- 在导出的sql文件的开头加上 set explicit_defaults_for_timestamp = 'ON';</span></span><br><span class="line"><span class="comment">-- show global variables like '%explicit_defaults_for_timestamp%';</span></span><br><span class="line"><span class="keyword">set</span> explicit_defaults_for_timestamp = <span class="string">'ON'</span>;</span><br></pre></td></tr></table></figure><h5 id="navicat-导入大sql文件报错-2006-mysql-server-has-gone-away"><a class="markdownIt-Anchor" href="#navicat-导入大sql文件报错-2006-mysql-server-has-gone-away"></a> navicat 导入大sql文件报错 <code>2006 - MySQL server has gone away</code></h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 直接在 SQL 文件最前面加入以下内容</span></span><br><span class="line"><span class="comment">-- show global variables like '%explicit_defaults_for_timestamp%';</span></span><br><span class="line"><span class="keyword">set</span> max_allowed_packet = <span class="number">1073741824</span>;</span><br><span class="line"><span class="comment">-- 如果无权限执行，可能更换高权限账号或者提高权限</span></span><br><span class="line"><span class="comment">-- set global max_allowed_packet = 1073741824;</span></span><br><span class="line"><span class="keyword">set</span> <span class="keyword">global</span> max_allowed_packet = <span class="number">1073741824</span>;</span><br></pre></td></tr></table></figure><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      
      
        &lt;!-- build time:Tue Jun 16 2020 13:17:34 GMT+0000 (Coordinated Universal Time) --&gt;&lt;h1 id=&quot;mysql-执行大批量-sql-文件随记&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot;
      
    
    </summary>
    
    
      <category term="MySQL" scheme="http://blog.uazw.com/categories/MySQL/"/>
    
    
      <category term="MySQL" scheme="http://blog.uazw.com/tags/MySQL/"/>
    
  </entry>
  
  <entry>
    <title>SQL语法</title>
    <link href="http://blog.uazw.com/2016/09/25/SQL/SQL%20%E8%AF%AD%E6%B3%95/"/>
    <id>http://blog.uazw.com/2016/09/25/SQL/SQL%20%E8%AF%AD%E6%B3%95/</id>
    <published>2016-09-25T04:13:00.000Z</published>
    <updated>2020-06-16T13:17:15.244Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Tue Jun 16 2020 13:17:34 GMT+0000 (Coordinated Universal Time) --><h1 id="sql-语法"><a class="markdownIt-Anchor" href="#sql-语法"></a> SQL 语法</h1><h3 id="日期获取"><a class="markdownIt-Anchor" href="#日期获取"></a> 日期获取</h3><ul><li>获取当前日期时间</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">now</span>();</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">sysdate</span>();</span><br></pre></td></tr></table></figure><ul><li>获取当前日期</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">curdate</span>();</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">current_date</span>;</span><br></pre></td></tr></table></figure><ul><li>获取当前时间 hh:mi:ss</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">time</span>(<span class="keyword">sysdate</span>());</span><br></pre></td></tr></table></figure><ul><li>获取 年、月、日、时、分、秒、毫秒</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*年*/</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">year</span>(<span class="keyword">current_date</span>);</span><br><span class="line"><span class="comment">/*月*/</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">month</span>(<span class="keyword">current_date</span>);</span><br><span class="line"><span class="comment">/*日*/</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">day</span>(<span class="keyword">current_date</span>);</span><br><span class="line"><span class="comment">/*时*/</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">hour</span>(<span class="keyword">sysdate</span>());</span><br><span class="line"><span class="comment">/*分*/</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">minute</span>(<span class="keyword">sysdate</span>());</span><br><span class="line"><span class="comment">/*秒*/</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">second</span>(<span class="keyword">sysdate</span>());</span><br><span class="line"><span class="comment">/*毫秒*/</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">microsecond</span>(<span class="keyword">sysdate</span>());</span><br></pre></td></tr></table></figure><h3 id="日期函数"><a class="markdownIt-Anchor" href="#日期函数"></a> 日期函数</h3><ul><li>日期运算</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*带时分秒的源日期计算之后也带时分秒*/</span></span><br><span class="line"><span class="comment">/*前一年*/</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">date_sub</span>(<span class="keyword">curdate</span>(), <span class="built_in">interval</span> <span class="number">1</span> <span class="keyword">year</span>);</span><br><span class="line"><span class="comment">/*前一月*/</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">date_sub</span>(<span class="keyword">curdate</span>(), <span class="built_in">interval</span> <span class="number">1</span> <span class="keyword">month</span>);</span><br><span class="line"><span class="comment">/*前一天日期*/</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">date_sub</span>(<span class="keyword">curdate</span>(), <span class="built_in">interval</span> <span class="number">1</span> <span class="keyword">day</span>);</span><br><span class="line"><span class="comment">/*前一小时*/</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">date_sub</span>(<span class="keyword">sysdate</span>(), <span class="built_in">interval</span> <span class="number">1</span> <span class="keyword">hour</span>);</span><br><span class="line"><span class="comment">/*前一分*/</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">date_sub</span>(<span class="keyword">sysdate</span>(), <span class="built_in">interval</span> <span class="number">1</span> <span class="keyword">minute</span>);</span><br><span class="line"><span class="comment">/*前一秒*/</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">date_sub</span>(<span class="keyword">sysdate</span>(), <span class="built_in">interval</span> <span class="number">1</span> <span class="keyword">second</span>);</span><br></pre></td></tr></table></figure><h3 id="日期格式化"><a class="markdownIt-Anchor" href="#日期格式化"></a> 日期格式化</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*yyyy-mm-dd hh24:mi:ss*/</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">str_to_date</span>(<span class="string">'2016-09-23 16:03:28'</span>, <span class="string">'%Y-%m-%d %H:%i:%s'</span>);</span><br><span class="line"><span class="comment">/*yyyy-mm-dd*/</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">str_to_date</span>(<span class="string">'2016-09-23 16:03:28'</span>, <span class="string">'%Y-%m-%d'</span>);</span><br></pre></td></tr></table></figure><h3 id="if-函数"><a class="markdownIt-Anchor" href="#if-函数"></a> if 函数</h3><ul><li>if</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">if</span>(<span class="string">'0'</span> = <span class="string">'1'</span>, <span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">if</span>(<span class="number">0</span> != <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>);</span><br></pre></td></tr></table></figure><ul><li>ifnull</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">ifnull</span>(<span class="literal">null</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">ifnull</span>(<span class="number">1</span>, <span class="number">0</span>);</span><br></pre></td></tr></table></figure><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      
      
        &lt;!-- build time:Tue Jun 16 2020 13:17:34 GMT+0000 (Coordinated Universal Time) --&gt;&lt;h1 id=&quot;sql-语法&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#sql-语法
      
    
    </summary>
    
    
      <category term="SQL" scheme="http://blog.uazw.com/categories/SQL/"/>
    
    
      <category term="MySQL" scheme="http://blog.uazw.com/tags/MySQL/"/>
    
      <category term="SQL" scheme="http://blog.uazw.com/tags/SQL/"/>
    
  </entry>
  
  <entry>
    <title>MySQL与Oracle SQL语法区别</title>
    <link href="http://blog.uazw.com/2016/09/23/SQL/MySQL%E4%B8%8EOracle%20SQL%E8%AF%AD%E6%B3%95%E5%8C%BA%E5%88%AB/"/>
    <id>http://blog.uazw.com/2016/09/23/SQL/MySQL%E4%B8%8EOracle%20SQL%E8%AF%AD%E6%B3%95%E5%8C%BA%E5%88%AB/</id>
    <published>2016-09-23T10:16:00.000Z</published>
    <updated>2020-06-16T13:17:15.244Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Tue Jun 16 2020 13:17:34 GMT+0000 (Coordinated Universal Time) --><h1 id="mysql与oracle-sql语法区别"><a class="markdownIt-Anchor" href="#mysql与oracle-sql语法区别"></a> MySQL与Oracle SQL语法区别</h1><blockquote><p>最近因为客户公司主张 <code>去IOE</code>，所以要求把项目上使用的 <code>Oracle</code> 数据库切换到 <code>MySQL</code>，所以花了点时间对项目进行重构，主要工作是修改 <code>SQL</code> 语法上，总结下重构过程遇到的 Oracle 和 MySQL 的语法区别，因为采用了 <code>MyBatis</code> 作为 ORM 框架，所以顺便把两种数据库都做了支持，配置切换。</p></blockquote><h1 id="日期类"><a class="markdownIt-Anchor" href="#日期类"></a> 日期类</h1><ul><li>MySQL</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 获取当前日期</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">curdate</span>();</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">current_date</span>;</span><br><span class="line"><span class="comment">-- 获取当前时间</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">now</span>();</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">sysdate</span>();</span><br><span class="line"><span class="comment">-- 获取时间中的年月日部分</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">date</span>(<span class="keyword">now</span>());</span><br><span class="line"><span class="comment">-- 获取时间中的时分秒部分</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">time</span>(<span class="keyword">now</span>());</span><br></pre></td></tr></table></figure><ul><li>Oracle</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 获取当前时间</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">sysdate</span> <span class="keyword">from</span> dual;</span><br></pre></td></tr></table></figure><h1 id="日期字符串转换"><a class="markdownIt-Anchor" href="#日期字符串转换"></a> 日期字符串转换</h1><ul><li>MySQL</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 字符串转为时间格式 */</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">str_to_date</span>(<span class="string">'2016-09-23 16:03:30'</span>, <span class="string">'%Y-%m-%d %H:%i:%s'</span>);</span><br><span class="line"><span class="comment">-- 2016-09-23 16:03:30</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">str_to_date</span>(<span class="string">'2016-09-22 16:03:30'</span>, <span class="string">'%Y-%m-%d'</span>);</span><br><span class="line"><span class="comment">-- 2016-09-22</span></span><br></pre></td></tr></table></figure><ul><li>Oracle</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 字符串转为时间格式，分秒不会消失 */</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">to_date</span>(<span class="string">'2016-09-23 16:03:30'</span>, <span class="string">'yyyy-mm-dd hh24:mi:ss'</span>) <span class="keyword">from</span> dual;</span><br><span class="line"><span class="comment">-- 2016-09-23 16:03:30</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">to_date</span>(<span class="string">'2016-09-22'</span>, <span class="string">'yyyy-mm-dd'</span>) <span class="keyword">from</span> dual;</span><br><span class="line"><span class="comment">-- 2016-09-22 00:00:00</span></span><br></pre></td></tr></table></figure><h1 id="简单判断函数"><a class="markdownIt-Anchor" href="#简单判断函数"></a> 简单判断函数</h1><ul><li>MySQL if函数</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* if(exp,attr0,attr1),如果exp为true，则返回attr0，false则返回attr1*/</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">if</span>(<span class="string">'0'</span>=<span class="string">'1'</span>,<span class="number">0</span>,<span class="number">1</span>);</span><br><span class="line"><span class="comment">-- 1</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">if</span>(<span class="number">0</span>!=<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>);</span><br><span class="line"><span class="comment">-- 0</span></span><br></pre></td></tr></table></figure><ul><li>Oracle decode</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* decode(exp0,exp1,attr0,attr1),如果exp0=exp1,则返回attr0，否则则返回attr1 */</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">decode</span>(<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>) <span class="keyword">from</span> dual;</span><br><span class="line"><span class="comment">-- 1</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">decode</span>(<span class="string">'0'</span>,<span class="string">'0'</span>,<span class="number">0</span>,<span class="number">1</span>) <span class="keyword">from</span> dual;</span><br><span class="line"><span class="comment">-- 0</span></span><br></pre></td></tr></table></figure><h1 id="对-null-的判断"><a class="markdownIt-Anchor" href="#对-null-的判断"></a> 对 null 的判断</h1><ul><li>MySQL ifnull</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* if(exp0,exp1)，如果exp0为null则返回exp1，如果exp0不为null则返回exp0 */</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">ifnull</span>(<span class="literal">null</span>,<span class="number">0</span>);</span><br><span class="line"><span class="comment">-- 0</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">ifnull</span>(<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line"><span class="comment">-- 1</span></span><br></pre></td></tr></table></figure><ul><li>Oracle nvl</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* nvl(exp0,exp1)，如果exp0为null则返回exp1，如果exp0不为null则返回exp0 */</span></span><br><span class="line"><span class="keyword">select</span> nvl(<span class="literal">null</span>,<span class="number">0</span>) <span class="keyword">from</span> dual;</span><br><span class="line"><span class="comment">-- 0</span></span><br><span class="line"><span class="keyword">select</span> nvl(<span class="number">1</span>,<span class="number">0</span>) <span class="keyword">from</span> dual;</span><br><span class="line"><span class="comment">-- 1</span></span><br></pre></td></tr></table></figure><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      
      
        &lt;!-- build time:Tue Jun 16 2020 13:17:34 GMT+0000 (Coordinated Universal Time) --&gt;&lt;h1 id=&quot;mysql与oracle-sql语法区别&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot;
      
    
    </summary>
    
    
      <category term="SQL" scheme="http://blog.uazw.com/categories/SQL/"/>
    
    
      <category term="MySQL" scheme="http://blog.uazw.com/tags/MySQL/"/>
    
      <category term="SQL" scheme="http://blog.uazw.com/tags/SQL/"/>
    
      <category term="Oracle" scheme="http://blog.uazw.com/tags/Oracle/"/>
    
  </entry>
  
  <entry>
    <title>Oracle 查看锁</title>
    <link href="http://blog.uazw.com/2016/08/10/SQL/Oracle%20%E6%9F%A5%E7%9C%8B%E9%94%81%E4%BF%A1%E6%81%AF/"/>
    <id>http://blog.uazw.com/2016/08/10/SQL/Oracle%20%E6%9F%A5%E7%9C%8B%E9%94%81%E4%BF%A1%E6%81%AF/</id>
    <published>2016-08-10T02:34:00.000Z</published>
    <updated>2020-06-16T13:17:15.244Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Tue Jun 16 2020 13:17:34 GMT+0000 (Coordinated Universal Time) --><h1 id="oracle-查看锁"><a class="markdownIt-Anchor" href="#oracle-查看锁"></a> Oracle 查看锁</h1><h3 id="相关表"><a class="markdownIt-Anchor" href="#相关表"></a> 相关表</h3><ul><li>v$lock</li><li>v$sqlarea</li><li>v$session</li><li>v$process</li><li>v$locked_object</li><li>all_objects</li><li>v$session_wait</li></ul><h3 id="查看被锁的和具体的操作用户信息"><a class="markdownIt-Anchor" href="#查看被锁的和具体的操作用户信息"></a> 查看被锁的和具体的操作用户信息</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">  do.owner,</span><br><span class="line">  do.object_name,</span><br><span class="line">  lo.session_id,</span><br><span class="line">  lo.locked_mode,</span><br><span class="line">  s.username,</span><br><span class="line">  s.sid,</span><br><span class="line">  s.serial<span class="comment">#,</span></span><br><span class="line">  s.username,</span><br><span class="line">  s.osuser,</span><br><span class="line">  s.machine,</span><br><span class="line">  s.terminal,</span><br><span class="line">  s.program,</span><br><span class="line">  s.action,</span><br><span class="line">  s.logon_time</span><br><span class="line"><span class="keyword">from</span></span><br><span class="line">  v$locked_object lo, dba_objects <span class="keyword">do</span>, v$<span class="keyword">session</span> s</span><br><span class="line"><span class="keyword">where</span></span><br><span class="line">  do.object_id = lo.object_id <span class="keyword">and</span> lo.session_id = s.sid</span><br></pre></td></tr></table></figure><h3 id="杀死进程"><a class="markdownIt-Anchor" href="#杀死进程"></a> 杀死进程</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sid + serial</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">system</span> <span class="keyword">kill</span> <span class="keyword">session</span> [<span class="keyword">sid</span>,<span class="built_in">serial</span><span class="comment">#];</span></span><br></pre></td></tr></table></figure><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      
      
        &lt;!-- build time:Tue Jun 16 2020 13:17:34 GMT+0000 (Coordinated Universal Time) --&gt;&lt;h1 id=&quot;oracle-查看锁&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#or
      
    
    </summary>
    
    
      <category term="Oracle" scheme="http://blog.uazw.com/categories/Oracle/"/>
    
    
      <category term="SQL" scheme="http://blog.uazw.com/tags/SQL/"/>
    
      <category term="Oracle" scheme="http://blog.uazw.com/tags/Oracle/"/>
    
  </entry>
  
</feed>
